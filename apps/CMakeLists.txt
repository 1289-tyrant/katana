function (compileApp name) 
  file(GLOB Sources *.cpp)
  add_executable(${name} ${Sources})
endfunction (compileApp)

function (linkRuntime name) 
  target_link_libraries(${name} galois) 
  target_link_libraries(${name} ${CMAKE_THREAD_LIBS_INIT}) 
  if(NOT USE_SOLARIS)
    target_link_libraries(${name} hoard)
  endif()

  if(USE_VTUNE)
    add_definitions(-DGALOIS_VTUNE)
    include_directories(${VTUNE_INCLUDE})
    target_link_libraries(${name} ${VTUNE_LIB})
    target_link_libraries(${name} dl)
  endif()

  if(USE_NUMA)
    target_link_libraries(${name} numa)
  endif()

  if(TBB_FOUND)
    target_link_libraries(${name} ${TBB_LIBRARIES})
  endif()
endfunction (linkRuntime)

function(app name)
  compileApp(${name})
  linkRuntime(${name})
  install(TARGETS ${name} DESTINATION bin)
endfunction(app)

if(LAPACK_FOUND)
  add_subdirectory(avi)
else()
  message("No LAPACK, not building avi")
endif()

add_subdirectory(barneshut)
add_subdirectory(betweennesscentrality)
add_subdirectory(boruvka)
add_subdirectory(clustering)
add_subdirectory(delaunayrefinement)
add_subdirectory(delaunaytriangulation)
add_subdirectory(des)
add_subdirectory(gmetis)
add_subdirectory(pagerank)
add_subdirectory(preflowpush)
add_subdirectory(sssp)
add_subdirectory(surveypropagation)
add_subdirectory(spanningtree)
